<layout>
    <div class="right_col" role="main">
        <div class="container">
            <div class="page-title">
                <div class="title_left">
                    <h3 style="padding:15px 0 5px 0">Offer Request</h3>
                </div>
            </div>
            <div class="clearfix"></div>
            <hr />
            <div class="col-md-12 col-sm-12 ">

                <form [formGroup]="form" (ngSubmit)="onSubmit()">
                    <div class="row">

                        <div class="col-md-4 col-sm-4">
                            <label for="distributor">Distributor</label>
                            <select id="distributor" type="text" formControlName="distributorid" class="form-control"
                                [ngClass]="{ ' is -invalid': submitted && f.distributorid.errors}">
                                <option *ngFor="let i of distributorList" value="{{i.id}}">{{i.distname}}
                                </option>
                            </select>
                            <div Style="display: block" *ngIf="submitted && f.distributorid.errors"
                                class="invalid-feedback">
                                <div *ngIf="f.distributorid.errors.required">
                                    distributor is required
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-4">
                            <label for="totalamount">Totalamount</label>
                            <br>
                            <select id="currency" style="display:inline-block; width:100px;"
                                formControlName="currencyId" class="form-control"
                                [ngClass]="{ ' is -invalid': submitted && f.currencyId.errors}">
                                <option *ngFor="let i of currencyList" value="{{i.id}}">{{i.code}}
                                </option>
                            </select>

                            <input id="totalamount" type="number" formControlName="totalamount" class="form-control"
                                style="display:inline-block; width:270px; margin-left: 5px;"
                                [ngClass]="{ ' is -invalid': submitted && f.totalamount.errors}" />
                            <div Style="display: block" *ngIf="submitted && f.totalamount.errors"
                                class="invalid-feedback">
                                <div *ngIf="f.totalamount.errors.required">
                                    totalamount is required
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4 col-sm-4">
                            <label for="status">Status</label>
                            <input id="status" type="text" formControlName="status" class="form-control"
                                [ngClass]="{ ' is -invalid': submitted && f.status.errors}" />
                            <div Style="display: block" *ngIf="submitted && f.status.errors" class="invalid-feedback">
                                <div *ngIf="f.status.errors.required">
                                    status is required
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-4">
                            <label for="podate">Podate</label>
                            <input id="podate" type="text" bsDatepicker formControlName="podate" class="form-control"
                                [ngClass]="{ ' is -invalid': submitted && f.podate.errors}" />
                            <div Style="display: block" *ngIf="submitted && f.podate.errors" class="invalid-feedback">
                                <div *ngIf="f.podate.errors.required">
                                    podate is required
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4 col-sm-4" style="display: none;">
                            <br />
                            <label for="isactive">
                                <input id="isactive" type="checkbox" formControlName="isactive">
                                Isactive
                            </label>
                        </div>
                    </div>

                    <div class="row" style="margin-top:50px">
                      <div class="col-md-9">
                        <label for="search">Search SpareParts By Part No. </label>
                        <input (input)="SparePartsSearch($event.target.value)" #sparePartsSearch list="browsers"
                               name="browser" id="browser" class="form-control">
                        <datalist id="browsers">
                          <option *ngFor="let i of sparePartsAutoComplete" value="{{i.partno}}">
                        </datalist>
                      </div>

                      <div class="col-md-3" style="margin-top:30px">
                        <button class="btn btn-primary" (click)="AddSpareParts(sparePartsSearch.value)"
                                type="button" class="btn btn-primary">Add SpareParts
                        </button>
                      </div>
                    </div>

                  <div class="row">
                    <ag-grid-angular style="width: 100%; margin-top: 2.5%; height: 250px;" class="ag-theme-alpine"
                                     (cellValueChanged)="onCellValueChanged($event)"
                                     (cellClicked)="RemoveSpareParts($event)"
                                     (gridReady)="onGridReady($event)" [columnDefs]="columnDefs"
                                     [rowData]="sparePartsList"
                                     rowSelection="single" pagination="true" paginationPageSize=10>
                    </ag-grid-angular>
                  </div>

                  <br/>

                  <div class="attachment my-4">
                    <div class="page-title">
                      <div class="title_left">
                        <h3>Attachments</h3>
                        <hr>
                      </div>
                    </div>

                    <div class="row" *ngIf="hasUpdateAccess || hasAddAccess" style="margin:15px;">
                      <div class="col-md-3">
                        <input type="file" id="myFile" #file placeholder="Choose file"
                               (change)="getfil(file.files); listfile(file.files) ;" multiple
                               accept="text/plain, application/pdf, image/*">
                      </div>
                      <div id="selectedfiles" class="hidden col-md-4"
                           style="max-height:200px; overflow-y:auto;display: none;">
                        <section style="margin:30px 0 0 50px; max-width:600px; min-width: 300px;">
                          <h5>Selected Files:</h5>
                          <hr/>
                        </section>

                      </div>
                    </div>

                    <ag-grid-angular *ngIf="hasId" style="width: 100%; height: 250px;" class="my-4 ag-theme-alpine"
                                     (gridReady)="onGridReadyAttachments($event)" [columnDefs]="columnDefsAttachments"
                                     [rowData]="attachments" rowSelection="single" pagination="true"
                                     paginationPageSize=10>
                    </ag-grid-angular>

                  </div>

                  <div class="row">
                    <div class="col-md-6 col-sm-6" style="padding:10px;">
                      <button
                        *ngIf="hasAddAccess || hasUpdateAccess" class="btn btn-primary" type="submit"
                        class="btn btn-primary"><span *ngIf="loading"
                                                      class="spinner-border spinner-border-sm mr-1">
                                </span> Submit
                      </button>
                      <a routerLink="/offerrequestlist" class="btn btn-secondary"
                         style="margin-left: 10px;">Back</a></div>
                  </div>
                </form>
            </div>
        </div>
    </div>
</layout>
